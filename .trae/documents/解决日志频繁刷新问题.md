# 解决日志频繁刷新问题

## 问题分析
1. **日志刷新频率过高**：前端每秒刷新一次日志，导致频繁请求和渲染
2. **自动展开日志逻辑问题**：当有多个运行中的实验时，`showLogs`状态会频繁切换
3. **实验列表频繁刷新**：实验列表每5秒刷新一次，导致整个组件重新渲染
4. **缺少WebSocket支持**：前端仍然使用轮询方式获取日志
5. **后端日志表不存在**：`experiment_logs`表不存在，导致日志API返回错误

## 实施计划

### 1. 修复后端日志表问题
- 创建`experiment_logs`表，确保日志API能够正常工作
- 修复`Experiment`模型中的关系定义，确保模型初始化成功

### 2. 实现WebSocket日志推送
- 更新前端代码，使用WebSocket连接获取实时日志
- 移除轮询逻辑，减少不必要的请求
- 确保WebSocket连接稳定，能够处理重连

### 3. 优化自动展开日志逻辑
- 只允许同时展开一个实验的日志
- 避免`showLogs`状态频繁切换
- 优化组件渲染，减少不必要的重新渲染

### 4. 优化日志渲染
- 使用React.memo优化日志组件
- 只渲染新增的日志行，避免整个日志区域重新渲染
- 添加日志滚动到底部功能，确保用户能看到最新日志

### 5. 减少实验列表刷新频率
- 将实验列表刷新频率从5秒降低到10秒
- 只在必要时刷新实验列表

## 预期结果
- 日志不再频繁刷新，用户体验得到改善
- 前端使用WebSocket获取实时日志，减少服务器负载
- 自动展开日志逻辑更加稳定，不会频繁切换
- 日志渲染更加流畅，只渲染新增日志
- 实验列表刷新频率降低，减少不必要的请求

## 注意事项
- 确保WebSocket连接安全，使用合适的认证机制
- 确保后端能够处理多个WebSocket连接
- 测试不同浏览器和网络环境下的性能
- 确保日志数据的完整性和一致性

## 后续优化建议
- 实现日志的分页加载，支持查看历史日志
- 添加日志搜索和过滤功能
- 实现日志的实时分析和可视化
- 添加日志告警功能，当出现错误时及时通知用户